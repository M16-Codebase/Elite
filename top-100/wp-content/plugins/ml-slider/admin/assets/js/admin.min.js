jQuery(function(e){var t=function(e){var t,i;window.getSelection?(i=window.getSelection(),t=document.createRange(),t.selectNodeContents(e),i.removeAllRanges(),i.addRange(t)):document.body.createTextRange&&(t=document.body.createTextRange(),t.moveToElementText(e),t.select());try{if(document.execCommand("copy")){var a=new MS_Notification(metaslider.success_language,metaslider.copied_language,(void 0),"is-success");a.fire(2e3)}}catch(s){console.log("MetaSlider: Couldn't copy the text")}};e(".ms-shortcode").on("click",function(){t(this)}),e(".ms-copy-all").on("click",function(e){e.preventDefault(),t(document.getElementById("ms-entire-code"))}),document.getElementById("ms-entire-code")&&document.getElementById("ms-entire-code").addEventListener("copy",function(e){var t=window.getSelection().toString().split("'").map(function(e,t){return 1===t?e.replace(/\s/g,"").replace("ri","r i"):e}).join("'");e.clipboardData.setData("text/plain",t),e.preventDefault()});var i={loaded:!1,attach_event:function(e){var t=e.state().get("library");e.listenTo(t,"change",function(e){i.update_slide_infos({id:e.get("id"),caption:e.get("caption"),title:e.get("title"),alt:e.get("alt")})})},update_slide_infos:function(t){var i=e(".slide").filter(function(i){return e(this).data("attachment-id")==t.id});t.caption?e(".caption .default",i).html(t.caption):e(".caption .default",i).html("&nbsp;"),t.title?e(".title .default",i).html(t.title):e(".title .default",i).html("&nbsp;"),t.alt?e(".alt .default",i).html(t.alt):e(".alt .default",i).html("&nbsp;")}},a=window.create_slides=wp.media.frames.file_frame=wp.media({multiple:"add",frame:"post",library:{type:"image"}});a.on("insert",function(){MetaSlider_Helpers.loading(!0);var t=[];a.state().get("selection").map(function(e){t.push(e.toJSON().id)});var i={action:"create_image_slide",slider_id:window.parent.metaslider_slider_id,selection:t,_wpnonce:metaslider.create_slide_nonce};e.ajax({url:metaslider.ajaxurl,data:i,type:"POST",beforeSend:function(){MetaSlider_Helpers.loading(!0)},complete:function(){MetaSlider_Helpers.loading(!1)},error:function(e){alert(e.responseJSON.data.message)},success:function(t){e(".metaslider .left table").append(t),MetaSlider_Helpers.loading(!1),e(".metaslider .left table").trigger("resizeSlides"),e(document).trigger("metaslider/slides-added")}})}),a.on("attach",function(){i.loaded||i.attach_event(a)});var s;e(".metaslider").on("click",".add-slide",function(t){t.preventDefault(),a.open(),e(".media-menu a:contains('Media Library')").remove()}),e(".metaslider").on("click",".update-image",function(t){t.preventDefault();var a=e(this),n=a.data("attachment-id");s=wp.media.frames.file_frame=wp.media({title:MetaSlider_Helpers.capitalize(metaslider.update_image),library:{type:"image"},button:{text:MetaSlider_Helpers.capitalize(a.attr("data-button-text"))}}),s.on("open",function(){if(n){var e=s.state().get("selection");e.reset([wp.media.attachment(n)])}}),s.on("attach",function(){i.loaded||i.attach_event(s)}),s.open(),s.on("select",function(){var t=s.state().get("selection");t.map(function(e){e=e.toJSON(),new_image_id=e.id,selected_item=e});var n={action:"update_slide_image",_wpnonce:metaslider.update_slide_image_nonce,slide_id:a.data("slideId"),slider_id:window.parent.metaslider_slider_id,image_id:new_image_id};e.ajax({url:metaslider.ajaxurl,data:n,type:"POST",beforeSend:function(){MetaSlider_Helpers.loading(!0)},complete:function(){MetaSlider_Helpers.loading(!1)},error:function(e){alert(e.responseJSON.data.message)},success:function(t){e("#slide-"+a.data("slideId")+" .thumb").css("background-image","url("+t.data.img_url+")");var s=e("#slide-"+a.data("slideId")+", #slide-"+a.data("slideId")+" .update-image");s.data("attachment-id",selected_item.id),i.update_slide_infos({id:selected_item.id,caption:selected_item.caption,title:selected_item.title,alt:selected_item.alt}),e(".metaslider .left table").trigger("resizeSlides")}})})}),e(".metaslider").on("change",".js-inherit-from-image",function(t){var i=e(this),a=i.parents(".can-inherit"),s=a.children("textarea,input[type=text]"),n=a.children(".default");i.is(":checked")?a.addClass("inherit-from-image"):(a.removeClass("inherit-from-image"),s.focus(),""===s.val()&&0===n.find(".no-content").length&&s.val(n.html()))}),e(".metaslider").on("click",".delete-slide",function(t){t.preventDefault();var i=e(this),a={action:"delete_slide",_wpnonce:metaslider.delete_slide_nonce,slide_id:i.data("slideId"),slider_id:window.parent.metaslider_slider_id};i.parents("#slide-"+i.data("slideId")).removeClass("ms-restored").addClass("ms-deleting").append('<div class="ms-delete-overlay"><i style="height:24px;width:24px"><svg class="ms-spin" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-loader"><line x1="12" y1="2" x2="12" y2="6"/><line x1="12" y1="18" x2="12" y2="22"/><line x1="4.93" y1="4.93" x2="7.76" y2="7.76"/><line x1="16.24" y1="16.24" x2="19.07" y2="19.07"/><line x1="2" y1="12" x2="6" y2="12"/><line x1="18" y1="12" x2="22" y2="12"/><line x1="4.93" y1="19.07" x2="7.76" y2="16.24"/><line x1="16.24" y1="7.76" x2="19.07" y2="4.93"/></svg></i></div>'),i.parents("#slide-"+i.data("slideId")).find(".ms-delete-status").remove(),e.ajax({url:metaslider.ajaxurl,data:a,type:"POST",error:function(e){alert(e.responseJSON.data.message),$slide=i.parents("#slide-"+i.data("slideId")),$slide.removeClass("ms-deleting"),$slide.find(".ms-delete-overlay").remove()},success:function(t){setTimeout(function(){$slide=i.parents("#slide-"+i.data("slideId")),$slide.addClass("ms-deleted").removeClass("ms-deleting").find(".metaslider-ui-controls").append('<button class="undo-delete-slide" title="'+metaslider.restore_language+'" data-slide-id="'+i.data("slideId")+'">'+metaslider.restore_language+"</button>");var t=$slide.find(".thumb").css("background-image").replace(/^url\(["']?/,"").replace(/["']?\)$/,"");t=window.location.href===t?"":t;var a=new MS_Notification(metaslider.deleted_language,metaslider.click_to_undo_language,t);a.fire(1e4,function(){jQuery("#slide-"+i.data("slideId")).addClass("hide-status").find(".undo-delete-slide").trigger("click")}),"none"==e(".restore-slide-link").css("display")&&e(".restore-slide-link").css("display","inline")},1e3)}})}),e(".metaslider").on("click",".undo-delete-slide, .trash-view-restore",function(t){t.preventDefault();var i=e(this),a={action:"undelete_slide",_wpnonce:metaslider.undelete_slide_nonce,slide_id:i.data("slideId"),slider_id:window.parent.metaslider_slider_id};e("#slide-"+i.data("slideId")).find(".undo-delete-slide").html(""),i.parents("#slide-"+i.data("slideId")).removeClass("ms-deleted").addClass("ms-deleting").css("padding-top","31px").append('<div class="ms-delete-overlay"><i style="height:24px;width:24px"><svg class="ms-spin" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-loader"><line x1="12" y1="2" x2="12" y2="6"/><line x1="12" y1="18" x2="12" y2="22"/><line x1="4.93" y1="4.93" x2="7.76" y2="7.76"/><line x1="16.24" y1="16.24" x2="19.07" y2="19.07"/><line x1="2" y1="12" x2="6" y2="12"/><line x1="18" y1="12" x2="22" y2="12"/><line x1="4.93" y1="19.07" x2="7.76" y2="16.24"/><line x1="16.24" y1="7.76" x2="19.07" y2="4.93"/></svg></i></div>'),i.parents("#slide-"+i.data("slideId")).find(".ms-delete-status").remove(),i.parents("#slide-"+i.data("slideId")).find(".delete-slide").focus(),e.ajax({url:metaslider.ajaxurl,data:a,type:"POST",error:function(e){$slide=i.parents("#slide-"+i.data("slideId")),$slide.removeClass("ms-restoring").addClass("ms-deleted"),$slide.find(".ms-delete-overlay").remove(),e.responseJSON?alert(e.responseJSON.data.message):alert("There was an error with the server and the action could not be completed.")},success:function(t){$slide=i.parents("#slide-"+i.data("slideId")),$slide.addClass("ms-restored"),$slide.removeClass("ms-deleting").find(".undo-delete-slide, .trash-view-restore").remove(),$slide.find(".ms-delete-overlay").remove(),e("#slide-"+i.data("slideId")+" h4").after('<span class="ms-delete-status is-success">'+metaslider.restored_language+"</span>"),e("#slide-"+i.data("slideId")).find(".row-actions.trash-btns").html("");var a=$slide.find(".thumb").css("background-image").replace(/^url\(["']?/,"").replace(/["']?\)$/,"");a=window.location.href===a?"":a;var s=new MS_Notification(metaslider.restored_language,"",a,"is-success");s.fire(5e3)}})});var n=function(t){e(".metaslider .option:not(."+t+")").attr("disabled","disabled").parents("tr").hide(),e(".metaslider .option."+t).removeAttr("disabled").parents("tr").show(),e(".metaslider input.radio:not(."+t+")").attr("disabled","disabled"),e(".metaslider input.radio."+t).removeAttr("disabled"),e(".metaslider .showNextWhenChecked:visible").parent().parent().next("tr").hide(),e(".metaslider .showNextWhenChecked:visible:checked").parent().parent().next("tr").show(),"disabled"===e(".effect option:selected").attr("disabled")&&e(".effect option:enabled:first").attr("selected","selected"),"disabled"===e(".theme option:selected").attr("disabled")&&e(".theme option:enabled:first").attr("selected","selected")};n(e(".metaslider .select-slider:checked").attr("rel"));var d=function(e){e.is(":checked")?e.parent().parent().next("tr").show():e.parent().parent().next("tr").hide()};d(e(".metaslider .showNextWhenChecked")),e(".metaslider .showNextWhenChecked").on("change",function(){d(e(this))}),e(".metaslider").on("change",".left tr.slide .crop_position",function(){e(this).closest("tr").data("crop_changed",!0)}),e(".metaslider .select-slider").on("click",function(){n(e(this).attr("rel"))});var l=function(t,i){return i.children().each(function(){e(this).width(e(this).width())}),i};e(".metaslider .left table tbody").sortable({helper:l,handle:"td.col-1",stop:function(){e(".metaslider .left table").trigger("updateSlideOrder"),e("#ms-save").click()}}),e(".metaslider .left table").live("updateSlideOrder",function(t){e("tr",this).each(function(){e("input.menu_order",e(this)).val(e(this).index())})}),e(".metaslider .left table").live("resizeSlides",function(t){var i=e("input.width").val(),a=e("input.height").val();e("tr.slide input[name='resize_slide_id']",this).each(function(){$this=e(this);var t=$this.attr("data-width"),s=$this.attr("data-height"),n=e(this).closest("tr"),d=n.data("crop_changed");if(t!=i||s!=a||d===!0){$this.attr("data-width",i),$this.attr("data-height",a);var l={action:"resize_image_slide",slider_id:window.parent.metaslider_slider_id,slide_id:$this.attr("data-slide_id"),_wpnonce:metaslider.resize_nonce};e.ajax({type:"POST",data:l,async:!1,cache:!1,url:metaslider.ajaxurl,success:function(e){d===!0&&n.data("crop_changed",!1),console&&console.log&&console.log(e)}})}})}),e(document).ajaxStop(function(){e(".metaslider .spinner").hide().css("visibility",""),e(".metaslider button[type=submit]").removeAttr("disabled")}),e(".useWithCaution").on("change",function(){if(!this.checked)return alert(metaslider.useWithCaution)}),e(".tipsy-tooltip").tipsy({className:"msTipsy",live:!0,delayIn:500,html:!0,gravity:"e"}),e(".tipsy-tooltip-top").tipsy({live:!0,delayIn:500,html:!0,gravity:"s"}),e(".metaslider .shortcode input, .metaslider .shortcode textarea").on("click",function(){this.select()});var r=function(){var t=parseInt(e("input.width").val(),10);return e(".carouselMode").is(":checked")&&(t="75%"),t},o=function(){var t=parseInt(e("input.height").val(),10),i=parseInt(e("input.thumb_height").val(),10);return isNaN(t)?t="70%":(t+=50,isNaN(i)||(t+=i)),t},c=function(){e("textarea").each(function(){e(this).val()==e(this).attr("placeholder")&&e(this).val("")})};e(".metaslider .ms-toggle .hndle, .metaslider .ms-toggle .handlediv").on("click",function(){e(this).parent().toggleClass("closed")}),e(".metaslider-ui").on("keypress","ul.tabs > li > a",function(t){32===t.which&&(t.preventDefault(),e(":focus").trigger("click"))}),e(".metaslider-ui").on("click","ul.tabs > li > a",function(t){t.preventDefault();var i=e(this);i.parents(".metaslider-ui-inner").children(".tabs-content").find("div.tab").hide(),i.parents(".metaslider-ui-inner").children(".tabs-content").find("div."+i.data("tab_id")).show(),i.parent().addClass("selected").siblings().removeClass("selected")}),e(".metaslider-ui").on("keypress",".slider-lib-row label",function(t){32===t.which&&(t.preventDefault(),e(".slider-lib-row #"+e(this).attr("for")).trigger("click"))}),e(".metaslider").on("click",".delete-slider",function(){return confirm(metaslider.confirm)}),e(".metaslider form").find("button[type=submit]").on("click",function(t){t.preventDefault(),e(".metaslider .spinner").show().css("visibility","visible"),e(".metaslider input[type=submit]").attr("disabled","disabled"),e(".metaslider .left table").trigger("updateSlideOrder"),c();var i=e(this).parents("form"),a=i.attr("action"),s=e(this),n=new FormData;i.serializeArray().forEach(function(e){n.append(e.name,e.value)}),e.ajax({type:"POST",data:n,cache:!1,contentType:!1,processData:!1,url:a,success:function(t){var i=e(t);e.when(e(".metaslider .left table").trigger("resizeSlides")).done(function(){e("button[data-thumb]",i).each(function(){var t=e(this),i=t.attr("data-editor_id");e("button[data-editor_id="+i+"]").attr("data-thumb",t.attr("data-thumb")).attr("data-width",t.attr("data-width")).attr("data-height",t.attr("data-height"))}),c(),"ms-preview"===s.prop("id")&&e.colorbox({iframe:!0,href:metaslider.iframeurl+"&slider_id="+s.data("slider_id"),transition:"elastic",innerHeight:o(),innerWidth:r(),scrolling:!0,fastIframe:!1})})}})}),e('.metaslider .nav-tab-active input[name="title"]').on("focusin",function(){e(this).css("width",9*(e(this).val().length+1))}).on("focusout",function(){e(this).css("width",150),e("#ms-save").trigger("click")}).on("keypress",function(){13===event.which&&(event.preventDefault(),e("#ms-save").trigger("click"),e("button.add-slide").focus())}),e('.metaslider input[name="title"]').on("input",function(t){t.preventDefault();var i=new MS_Binder(".slider-title > h3");i.bind(e(this).val())})});var MetaSlider_Helpers={capitalize:function(e){return e.replace(/\b\w/g,function(e){return e.toUpperCase()})},loading:function(e){e?(jQuery(".metaslider .spinner").show().css("visibility","visible"),jQuery(".metaslider button[type=submit]").attr("disabled","disabled")):(jQuery(".metaslider .spinner").hide().css("visibility",""),jQuery(".metaslider button[type=submit]").removeAttr("disabled"))}},MS_Binder=function(e){this.dom=document.querySelector(e),this.value=null};MS_Binder.prototype.bind=function(e){e!==this.value&&(this.value=e,this.dom.innerText=this.value)};var MS_Notification=function(e,t,i,a){this.panel=document.getElementById("ms-notifications"),this.panel||(this.panel=document.createElement("div"),this.panel.id="ms-notifications"),this.notice=jQuery('<div class="ms-notification"><div class="ms-notification-content"><h3></h3><p></p></div><div class="img"></div></div>'),this.notice.find("h3").text(e),this.notice.find("p").text(t),"undefined"!=typeof i&&i.length&&this.notice.addClass("has-image").find(".img").append('<img width=50 height=50 src="'+i+'">'),"undefined"!=typeof a&&this.notice.addClass(a),jQuery(this.panel).appendTo(jQuery("body"))};MS_Notification.prototype.hide=function(){var e=this;e.notice.addClass("finished"),this.notice.fadeOut(500,function(){e.notice.remove()})},MS_Notification.prototype.fire=function(e,t){var i=this,a="undefined"!=typeof t?t:"hide";this.notice.prependTo(this.panel),this.timeout=setTimeout(function(){i.hide()},e),this.notice.on("click",function(){clearTimeout(i.timeout)}),this.notice.on("mouseenter",function(){clearTimeout(i.timeout)}),this.notice.on("mouseleave",function(){i.timeout=setTimeout(function(){i.hide()},e)}),MS_Notification.prototype.hasOwnProperty(a)?this.notice.on("click",function(){"hide"!==a&&i.hide(),MS_Notification.call(i[a]())}):this.notice.on("click",function(){i.hide(),a()})};